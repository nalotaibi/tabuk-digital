<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <link rel="apple-touch-icon" href="1024.png">
    <link rel="icon" href="1024.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø°ÙƒÙŠØ©</title>
    <style>
        :root {
            /* Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù…Ø³ØªØ®Ø±Ø¬Ø© Ù…Ù† Ø§Ù„Ø´Ø¹Ø§Ø± */
            --primary: #92d050;      /* Ø§Ù„Ø£Ø®Ø¶Ø± Ø§Ù„ÙØ§ØªØ­ */
            --secondary: #00b0f0;    /* Ø§Ù„ØªØ±ÙƒÙˆØ§Ø²ÙŠ */
            --text-dark: #404040;    /* Ø§Ù„Ø±Ù…Ø§Ø¯ÙŠ Ø§Ù„Ø¯Ø§ÙƒÙ† Ù„Ù„Ù†ØµÙˆØµ */
            --safe: #92d050;
            --warning: #facc15;
            --orange: #fb923c;
            --danger: #ef4444;
            --bg-gradient: linear-gradient(135deg, #f7faf9 0%, #eef3f2 100%);
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: var(--bg-gradient);
            padding: 20px 10px;
            direction: rtl;
            min-height: 100vh;
            color: var(--text-dark);
        }

        /* Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø´ÙØ§ÙØ© - Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆØ³Ø· Ø§Ù„ÙƒØ§Ù…Ù„ */
        .modal-overlay {
            display: none; 
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 9999;
            justify-content: center; 
            align-items: center;     
        }

        .modal-content {
            background: white;
            padding: 25px 20px;
            border-radius: 24px;
            width: 85%;
            max-width: 340px;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            text-align: center;
            box-sizing: border-box;
        }

        .modal-header { 
            font-weight: 800; color: var(--text-dark); margin-bottom: 20px; 
            font-size: 1.1rem; display: flex; align-items: center; justify-content: center; gap: 8px;
        }

        .guide-item b { color: var(--secondary); display: block; margin-bottom: 5px; }

        .close-modal {
            background: var(--primary); color: white; border: none; padding: 12px;
            border-radius: 12px; width: 100%; margin-top: 10px; cursor: pointer; font-weight: bold;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØ«Ø¨ÙŠØª */
        .install-banner {
            background: #ffffff; border: 1px solid #e1e9e7; padding: 10px 15px;
            border-radius: 16px; margin-bottom: 20px; display: flex; align-items: center;
            justify-content: space-between; box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }
        .install-text { font-weight: 700; color: var(--text-dark); font-size: 0.82rem; }
        .install-btn {
            background: var(--secondary); color: white; border: none; padding: 6px 14px;
            border-radius: 10px; font-size: 0.78rem; font-weight: bold; cursor: pointer;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .college-logo img { width: 200px; margin-bottom: 10px; }
        .header-text h1 { margin: 0; font-size: 1.6rem; color: var(--text-dark); font-weight: 800; }
        .system-badge { display: inline-block; margin-top: 8px; padding: 4px 12px; background: #e8f5e9; color: #2e7d32; border-radius: 20px; font-size: 0.75rem; font-weight: bold; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .action-bars { display: flex; gap: 10px; margin: 20px 0; }
        .add-btn { flex: 2; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 12px rgba(146, 208, 80, 0.3); }
        .reset-all { flex: 1; padding: 14px; background: #fff; color: var(--text-dark); border: 1px solid #ddd; border-radius: 16px; cursor: pointer; }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
        .course-card { background: white; border-radius: 28px; padding: 22px; margin-bottom: 20px; box-shadow: 0 12px 30px rgba(0,0,0,0.06); border: 1px solid #c8dcd5; position: relative; }
        .course-title { width: 85%; border: none; border-bottom: 2px solid #f0f0f0; font-size: 1.1rem; font-weight: bold; color: var(--text-dark); margin-bottom: 15px; padding: 5px; outline: none; }
        
        .input-group label { display: block; font-size: 0.8rem; color: var(--text-dark); margin-bottom: 6px; font-weight: 700; background: #f8faf9; padding: 4px 10px; border-right: 3px solid var(--secondary); }
        
        select, input { width: 100%; padding: 10px; border-radius: 12px; border: 1.5px solid #edf2f1; text-align: center; outline: none; box-sizing: border-box; }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª */
        .hint-icon { display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; background: var(--secondary); color: white; border-radius: 50%; font-size: 0.7rem; margin-right: 5px; cursor: pointer; vertical-align: middle; font-weight: bold; }
        .info-icon { display: inline-flex; align-items: center; justify-content: center; width: 18px; height: 18px; background: #cbd5e0; color: white; border-radius: 50%; font-size: 0.8rem; margin-right: 5px; cursor: pointer; }

        .result-area { border-radius: 20px; padding: 15px; margin-top: 15px; text-align: center; }
        .progress-bar { height: 8px; background: #e5e7eb; border-radius: 4px; margin: 10px 0; overflow: hidden; }
        .progress-fill { height: 100%; transition: 0.8s ease-in-out; }
    </style>
</head>
<body>

<div id="guideModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header"><span>ğŸ“± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ù„Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
        <div style="text-align: right; font-size: 0.9rem; line-height: 1.6;">
            <b>ğŸ Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠ iPhone (Safari)</b>
            Ø§Ø¶ØºØ·ÙŠ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© â¬†ï¸ Ø«Ù… <b>"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"</b>.
            <br><br>
            <b>ğŸ¤– Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠ Android (Chrome)</b>
            Ø§Ø¶ØºØ·ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø«Ù„Ø§Ø« â‹® Ø«Ù… <b>"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"</b>.
        </div>
        <button class="close-modal" onclick="toggleModal(false)">ÙÙ‡Ù…Øª Ø°Ù„Ùƒ</button>
    </div>
</div>

<div class="app-container">
    <div class="install-banner">
        <div class="install-text">Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ÙƒØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ù‡Ø§ØªÙÙƒ</div>
        <button class="install-btn" onclick="toggleModal(true)">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©</button>
    </div>

    <header style="text-align: center; margin-bottom: 20px;">
        <div class="college-logo"><img src="IMG_1800.png" alt="Logo"></div>
        <div class="header-text">
            <h1>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø°ÙƒÙŠØ©</h1>
            <span class="system-badge">Ù†Ø¸Ø§Ù… 16 Ø£Ø³Ø¨ÙˆØ¹Ù‹Ø§ (20% Ø­Ø±Ù…Ø§Ù†)</span>
        </div>
    </header>

    <div class="action-bars">
        <button class="add-btn" onclick="addNewCourse()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø±Ø± Ø¬Ø¯ÙŠØ¯</button>
        <button class="reset-all" onclick="clearEverything()">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
    </div>

    <div id="coursesList"></div>
</div>

<script>
    let courses = JSON.parse(localStorage.getItem('myCourses')) || [];

    function toggleModal(show) {
        document.getElementById('guideModal').style.display = show ? 'flex' : 'none';
    }

    function fixNumbers(str) {
        return str.replace(/[Ù -Ù©]/g, d => d.charCodeAt(0) - 1632).replace(/[^\d.]/g, '');
    }

    function addNewCourse() {
        courses.push({ id: Date.now(), name: 'Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø±Ø±', weeklyHours: 4, absent1: '', absent2: '' });
        renderCourses();
    }

    function renderCourses() {
        const list = document.getElementById('coursesList');
        list.innerHTML = '';
        
        courses.forEach(course => {
            const weeklyH = parseFloat(course.weeklyHours) || 0;
            const limit = (weeklyH * 16) * 0.20; 
            const currentAbsent = (parseFloat(course.absent1) || 0) + ((parseFloat(course.absent2) || 0) * 2);
            const percent = (currentAbsent / (weeklyH * 16)) * 100 || 0;

            const card = document.createElement('div');
            card.className = 'course-card';
            card.innerHTML = `
                <button style="position:absolute; top:15px; left:15px; border:none; background:#fee2e2; color:#ef4444; border-radius:50%; width:25px; height:25px;" onclick="deleteCourse(${course.id})">âœ•</button>
                <input type="text" class="course-title" value="${course.name}" onchange="updateCourse(${course.id}, 'name', this.value)">
                
                <div class="input-group">
                    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</label>
                    <select onchange="updateCourse(${course.id}, 'weeklyHours', this.value)">
                        ${[1,2,3,4,5,6].map(h => `<option value="${h}" ${course.weeklyHours == h ? 'selected' : ''}>${h} Ø³Ø§Ø¹Ø§Øª</option>`).join('')}
                    </select>
                </div>

                <div class="input-group">
                    <label>Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„ØºÙŠØ§Ø¨</label>
                    <div style="display:flex; gap:10px;">
                        <div style="flex:1">
                            <span style="font-size:0.7rem; display:block; margin-bottom:4px;">
                                <span class="hint-icon" onclick="alert('ğŸ’¡ Ù…Ø­Ø§Ø¶Ø±Ø© ÙØ¦Ø© Ø³Ø§Ø¹ØªÙŠÙ†: Ø¹Ù†Ø¯ Ø§Ù„ØºÙŠØ§Ø¨ Ø¹Ù†Ù‡Ø§ ÙŠÙØ­Ø³Ø¨ Ù„Ùƒ Ø³Ø§Ø¹ØªÙŠÙ† ØºÙŠØ§Ø¨.')">?</span> ÙØ¦Ø© Ø³Ø§Ø¹ØªÙŠÙ†
                            </span>
                            <input type="text" inputmode="numeric" value="${course.absent2}" placeholder="0" oninput="el => { el.target.value = fixNumbers(el.target.value); updateCourse(${course.id}, 'absent2', el.target.value) }">
                        </div>
                        <div style="flex:1">
                            <span style="font-size:0.7rem; display:block; margin-bottom:4px;">
                                <span class="hint-icon" onclick="alert('ğŸ’¡ Ù…Ø­Ø§Ø¶Ø±Ø© ÙØ¦Ø© Ø³Ø§Ø¹Ø©: Ø¹Ù†Ø¯ Ø§Ù„ØºÙŠØ§Ø¨ Ø¹Ù†Ù‡Ø§ ØªÙØ­Ø³Ø¨ Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·.')">?</span> ÙØ¦Ø© Ø³Ø§Ø¹Ø©
                            </span>
                            <input type="text" inputmode="numeric" value="${course.absent1}" placeholder="0" oninput="el => { el.target.value = fixNumbers(el.target.value); updateCourse(${course.id}, 'absent1', el.target.value) }">
                        </div>
                    </div>
                </div>

                <div class="result-area" style="background:${percent > 20 ? '#fef2f2' : '#f0fdf4'}">
                    <div style="font-weight:bold; color:${percent > 20 ? 'var(--danger)' : 'var(--primary)'}">${percent > 20 ? 'ğŸ”´ Ø­Ø§Ù„Ø© Ø­Ø±Ù…Ø§Ù†' : 'ğŸŸ¢ ÙˆØ¶Ø¹Ùƒ Ø¢Ù…Ù†'}</div>
                    <div style="font-size:1.5rem; font-weight:900; margin:10px 0;">${percent.toFixed(1)}%</div>
                    <div class="progress-bar"><div class="progress-fill" style="width:${Math.min((percent/20)*100, 100)}%; background:${percent > 15 ? 'var(--danger)' : 'var(--primary)'}"></div></div>
                    <div style="font-size:0.75rem;">Ø­Ø¯ Ø§Ù„Ø­Ø±Ù…Ø§Ù†: ${limit.toFixed(1)} Ø³Ø§Ø¹Ø© <span class="info-icon" onclick="alert('Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø±Ù…Ø§Ù†: ${weeklyH} Ø³Ø§Ø¹Ø§Øª Ã— 16 Ø£Ø³Ø¨ÙˆØ¹ Ã— 20% = ${limit.toFixed(1)}')">i</span></div>
                </div>
            `;
            list.appendChild(card);
        });
        localStorage.setItem('myCourses', JSON.stringify(courses));
    }

    function updateCourse(id, field, value) {
        const idx = courses.findIndex(c => c.id === id);
        if (idx !== -1) { courses[idx][field] = value; renderCourses(); }
    }
    function deleteCourse(id) { if(confirm('Ø­Ø°ÙØŸ')) { courses = courses.filter(c => c.id !== id); renderCourses(); } }
    function clearEverything() { if(confirm('Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„ØŸ')) { courses = []; renderCourses(); } }

    window.onload = renderCourses;
</script>
</body>
</html>
